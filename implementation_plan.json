{
  "spec_id": "045-add-api-profile-providers-usage-endpoints-support-",
  "subtasks": [
    {
      "id": "1",
      "title": "Implement provider detection from baseUrl (Anthropic, z.ai, ZHIPU)",
      "status": "completed"
    },
    {
      "id": "2",
      "title": "Implement usage endpoint routing based on provider type",
      "status": "completed"
    },
    {
      "id": "3",
      "title": "Implement response normalization for z.ai quota/limit endpoint",
      "status": "completed"
    },
    {
      "id": "4",
      "title": "Implement response normalization for ZHIPU quota/limit endpoint",
      "status": "completed"
    },
    {
      "id": "5",
      "title": "Implement authentication handling for API profiles (apiKey vs OAuth token)",
      "status": "completed"
    }
  ],
  "qa_signoff": {
    "status": "fixes_applied",
    "timestamp": "2026-01-18T01:30:00Z",
    "fix_session": 5,
    "issues_fixed": [
      {
        "title": "Usage values not displaying correctly for z.ai and ZHIPU providers",
        "fix_commit": "df81cca8",
        "description": "Changed from model-usage endpoint to quota/limit endpoint and updated response parsing to extract limits array"
      },
      {
        "title": "Usage labels and reset times not user-friendly",
        "fix_commit": "6331d11c",
        "description": "Updated session label to '5 Hours Quota', weekly label to 'Total Monthly Tools Quota', calculated actual reset times for 5-hour window, and formatted monthly reset as '1st of <Month>'"
      },
      {
        "title": "Additional percentage display needs to be removed",
        "fix_commit": "94afd21e",
        "description": "Removed percentage text from usage warning badge; now only shows AlertTriangle icon with percentage in tooltip"
      },
      {
        "title": "Countdown timer needs to move to right of usage badge",
        "fix_commit": "94afd21e",
        "description": "Moved countdown timer from tooltip to visible blue badge positioned to the right of provider badge"
      },
      {
        "title": "Duplicate 'Resets:' word in tooltip",
        "fix_commit": "037fa6a1",
        "description": "Removed duplicate 'Resets:' prefix from tooltips in UsageIndicator and AuthStatusIndicator components"
      },
      {
        "title": "Monthly Tools badge should show 5 hour usage instead",
        "fix_commit": "037fa6a1",
        "description": "Replaced countdown timer badge with 5 hour usage badge that shows session percentage"
      },
      {
        "title": "5 hour usage badge should only show when >= 90% and in red",
        "fix_commit": "037fa6a1",
        "description": "Badge is hidden until session usage reaches 90% threshold, then displays in red with percentage"
      },
      {
        "title": "Time synchronization issue with reset countdown",
        "fix_commit": "037fa6a1",
        "description": "Store ISO timestamps and calculate relative time dynamically in UI instead of at fetch time, ensuring countdown stays accurate"
      },
      {
        "title": "5-hour window reset time showing duration from start instead of time remaining",
        "fix_commit": "52b53f83",
        "description": "Fixed sessionResetTimestamp calculation to align with 5-hour interval boundaries (0:00, 5:00, 10:00, 15:00, 20:00) instead of just next hour. The tooltip now correctly shows time remaining until the window resets. Verified >=90% badge is based on actual usage percentage from API, not time-based calculation."
      }
    ],
    "ready_for_qa_revalidation": true
  }
}
